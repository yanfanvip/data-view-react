{"version":3,"file":"index.js","sources":["../../src/components/decoration1/index.js"],"sourcesContent":["import React, { useMemo, forwardRef } from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport classnames from 'classnames'\n\nimport { deepMerge } from '@jiaminghi/charts/lib/util/index'\nimport { deepClone } from '@jiaminghi/c-render/lib/plugin/util'\n\nimport useAutoResize from '../../use/autoResize'\n\nimport './style.less'\n\nconst defaultColor = ['#fff', '#0de7c2']\n\nconst pointSideLength = 2.5\n\nconst halfPointSideLength = pointSideLength / 2\n\nconst svgWH = [200, 50]\n\nconst rowNum = 4\n\nconst rowPoints = 20\n\nfunction getPoints() {\n  const [w, h] = svgWH\n\n  const horizontalGap = w / (rowPoints + 1)\n  const verticalGap = h / (rowNum + 1)\n\n  const points = new Array(rowNum)\n    .fill(0)\n    .map((foo, i) =>\n      new Array(rowPoints)\n        .fill(0)\n        .map((foo, j) => [horizontalGap * (j + 1), verticalGap * (i + 1)])\n    )\n\n  return points.reduce((all, item) => [...all, ...item], [])\n}\n\nconst Decoration = forwardRef(({ className, style, color = [] }, ref) => {\n  const { width, height, domRef } = useAutoResize(ref)\n\n  function calcSVGData() {\n    const points = getPoints()\n\n    return {\n      points,\n      rects: [points[rowPoints * 2 - 1], points[rowPoints * 2 - 3]],\n      svgScale: [width / svgWH[0], height / svgWH[1]]\n    }\n  }\n\n  const mergedColor = useMemo(() => deepMerge(deepClone(defaultColor, true), color || []), [color])\n\n  const { svgScale, points, rects } = useMemo(calcSVGData, [width, height])\n\n  const classNames = useMemo(() => classnames('dv-decoration-1', className), [\n    className\n  ])\n\n  return (\n    <div className={classNames} style={style} ref={domRef}>\n      <svg\n        width={`${svgWH[0]}px`}\n        height={`${svgWH[1]}px`}\n        style={{ transform: `scale(${svgScale[0]},${svgScale[1]})` }}\n      >\n        {points.reduce((prev, point, i) => {\n          return Math.random() > 0.6\n            ? [\n              ...prev,\n              <rect\n                key={i}\n                fill={mergedColor[0]}\n                x={point[0] - halfPointSideLength}\n                y={point[1] - halfPointSideLength}\n                width={pointSideLength}\n                height={pointSideLength}\n              >\n                {Math.random() > 0.6 && (\n                  <animate\n                    attributeName='fill'\n                    values={`${mergedColor[0]};transparent`}\n                    dur='1s'\n                    begin={Math.random() * 2}\n                    repeatCount='indefinite'\n                  />\n                )}\n              </rect>\n            ]\n            : prev\n        }, [])}\n        {!!rects[0] && (\n          <rect\n            fill={mergedColor[1]}\n            x={rects[0][0] - pointSideLength}\n            y={rects[0][1] - pointSideLength}\n            width={pointSideLength * 2}\n            height={pointSideLength * 2}\n          >\n            <animate\n              attributeName='width'\n              values={`0;${pointSideLength * 2}`}\n              dur='2s'\n              repeatCount='indefinite'\n            />\n            <animate\n              attributeName='height'\n              values={`0;${pointSideLength * 2}`}\n              dur='2s'\n              repeatCount='indefinite'\n            />\n            <animate\n              attributeName='x'\n              values={`${rects[0][0]};${rects[0][0] - pointSideLength}`}\n              dur='2s'\n              repeatCount='indefinite'\n            />\n            <animate\n              attributeName='y'\n              values={`${rects[0][1]};${rects[0][1] - pointSideLength}`}\n              dur='2s'\n              repeatCount='indefinite'\n            />\n          </rect>\n        )}\n        {!!rects[1] && (\n          <rect\n            fill={mergedColor[1]}\n            x={rects[1][0] - 40}\n            y={rects[1][1] - pointSideLength}\n            width='40'\n            height={pointSideLength * 2}\n          >\n            <animate\n              attributeName='width'\n              values='0;40;0'\n              dur='2s'\n              repeatCount='indefinite'\n            />\n            <animate\n              attributeName='x'\n              values={`${rects[1][0]};${rects[1][0] - 40};${rects[1][0]}`}\n              dur='2s'\n              repeatCount='indefinite'\n            />\n          </rect>\n        )}\n      </svg>\n    </div>\n  )\n})\n\nDecoration.propTypes = {\n  className: PropTypes.string,\n  style: PropTypes.object,\n  color: PropTypes.array\n}\n\nexport default Decoration\n"],"names":["defaultColor","pointSideLength","halfPointSideLength","svgWH","rowNum","rowPoints","getPoints","w","h","horizontalGap","verticalGap","points","Array","fill","map","foo","i","j","reduce","all","item","Decoration","forwardRef","ref","className","style","color","useAutoResize","width","height","domRef","calcSVGData","rects","svgScale","mergedColor","useMemo","deepMerge","deepClone","classNames","classnames","React","transform","prev","point","Math","random","propTypes","PropTypes","string","object","array"],"mappings":"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"}